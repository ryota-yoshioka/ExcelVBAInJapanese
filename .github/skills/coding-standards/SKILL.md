# VBAコーディング標準

このドキュメントは、ExcelVBAInJapaneseプロジェクトにおけるVBAコーディング標準を定義します。

## 命名規則

### クラス名
- PascalCase（日本語）で記述
- 例：`セル`、`セル範囲`、`ワークシート`、`ワークブック`
- 日本語で機能が明確に理解できる名前を使用

### プロパティ名
- PascalCase（日本語）で記述
- 名詞、または体言止めで命名
- 例：`幅`、`高さ`、`インデントを追加`

### メソッド名
- PascalCase（日本語）で記述
- 動作を表す動詞を含める
- 例：`取得する`、`設定する`、`削除する`、`追加する`

### 変数名
- camelCase（日本語）で記述
- 変数がラップ対象となるExcelオプジェクトの場合
  - 変数名は `ハンドル`、アクセスレベルはPrivate
- スコープに応じたプレフィックスを使用：
  - `m_` - クラスレベルのプライベート変数
  - `g_` - グローバル変数（必要な場合のみ）
- 例：`m_セル範囲`、`m_値`

### 定数名
- UPPER_SNAKE_CASE（英数字）で記述
- 物理的な定数はこの形式で統一
- 例：`EXCEL_VERSION`、`MAX_ROWS`

## ファイル形式

- クラスモジュール：`.cls`拡張子
- 標準モジュール（テスト含む）：`.bas`拡張子
- ファイル名は日本語クラス名に統一

## クラス構成

### クラスの基本構造
1. 宣言セクション（プライベート変数）
2. 初期化メソッド（`新規`など）
3. プロパティメソッド（Get/Let）
4. その他メソッド
5. ヘルパーメソッド

### プロパティの実装
- Get/Letメソッドペアで実装
- Getメソッド：`～を取得`の形式
- Letメソッド：`～を設定`の形式

## コメント

- コメントは日本語で記述
- クラス、メソッド、複雑なロジックにのみ記述
- 過度なコメントは避ける

## エラーハンドリング

- `On Error`ステートメントを必要に応じて使用
- エラー番号でハンドリング
- ユーザーフレンドリーなエラーメッセージを提供

## テスト

- テストは`.bas`ファイルで実装
- テスト関数名は`テスト_`で始まる
- 例：`テスト_セル範囲_値を取得`

## 依存関係

- VBAプロジェクトの依存関係を最小化
- Excel標準オブジェクトモデルを使用
- Scripting Library（FSO）を適切に利用

## オブジェクト参照

- COM参照は明示的に使用
- Excelオブジェクト（Range、Worksheetなど）を適切にラップ
- メモリリーク防止のため、不要な参照は`Nothing`に設定

## パフォーマンス

- 大量データ処理時は配列の使用を検討
- 画面更新は`Application.ScreenUpdating`で制御
- 計算モードは`Application.Calculation`で制御（必要に応じて）

## 制限事項

- VBA独自の言語仕様に準拠
- Excelバージョン互換性を考慮（推奨：Excel 2019以降）
